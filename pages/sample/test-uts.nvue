<template>
	<view class="content">
		<text class="title">UTS控件测试页面</text>
		
		<!-- 使用UTS自定义控件 -->
		<!-- #ifdef APP-PLUS -->
		<view class="button-container">
			<uts-button 
				ref="utsButton" 
				:buttontext="buttonText" 
				@buttonclick="onButtonClick"
				class="uts-button">
			</uts-button>
		</view>
		<!-- #endif -->
		
		<!-- #ifndef APP-PLUS -->
		<view class="button-container">
			<button type="primary" @click="onButtonClick" class="fallback-button">{{buttonText}}（模拟按钮）</button>
		</view>
		<!-- #endif -->
		
		<text class="result" v-if="result">{{result}}</text>
		
		<text class="debug-info">平台: {{platform}}</text>
	</view>
</template>

<script>
	export default {
		data() {
			return {
				buttonText: '点击测试UTS控件',
				result: '',
				platform: ''
			}
		},
		onLoad() {
			// 页面加载时的逻辑
			console.log('nvue页面加载完成');
			
			// 获取平台信息
			// #ifdef APP-PLUS
			this.platform = 'APP-PLUS: ' + plus.os.name;
			console.log('当前平台: APP-PLUS - ' + plus.os.name);
			// #endif
			
			// #ifdef H5
			this.platform = 'H5';
			console.log('当前平台: H5');
			// #endif
			
			// 检查UTS控件是否可用
			setTimeout(() => {
				// #ifdef APP-PLUS
				if (this.$refs.utsButton) {
					console.log('UTS控件已加载');
					this.result = 'UTS控件已加载，请点击测试';
				} else {
					console.log('UTS控件未加载');
					this.result = 'UTS控件未加载，请检查配置';
				}
				// #endif
			}, 1000);
		},
		methods: {
			// 按钮点击事件处理函数
			onButtonClick() {
				console.log('按钮被点击了！');
				this.result = '按钮点击成功！时间: ' + new Date().toLocaleTimeString();
				
				// #ifdef APP-PLUS
				// 调用UTS控件的方法
				if (this.$refs.utsButton) {
					this.$refs.utsButton.doSomething('来自NVUE的调用');
					console.log('调用了UTS控件的doSomething方法');
				} else {
					console.log('UTS控件不可用，无法调用方法');
				}
				// #endif
				
				// 显示提示
				uni.showToast({
					title: '按钮点击成功',
					icon: 'success'
				});
			}
		}
	}
</script>

<style>
	.content {
		flex: 1;
		padding: 20px;
		background-color: #F8F8F8;
		align-items: center;
	}
	
	.title {
		font-size: 18px;
		color: #333333;
		margin-bottom: 40px;
		margin-top: 40px;
	}
	
	.button-container {
		width: 300px;
		height: 50px;
		margin-bottom: 20px;
	}
	
	.uts-button {
		width: 300px;
		height: 50px;
	}
	
	.fallback-button {
		width: 300px;
		height: 50px;
	}
	
	.result {
		margin-top: 30px;
		font-size: 14px;
		color: #007AFF;
		padding: 10px;
		border-width: 1px;
		border-color: #DDDDDD;
		border-radius: 5px;
		background-color: #FFFFFF;
		width: 300px;
		text-align: center;
	}
	
	.debug-info {
		margin-top: 20px;
		font-size: 12px;
		color: #999999;
	}
</style> 